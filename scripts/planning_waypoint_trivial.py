#/usr/bin/env python
import time
from hpp.corbaserver.motion_prior.client import Client as MPClient
import rospy
from hrp2 import Robot 
from hpp_ros import ScenePublisher, PathPlayer
from hpp.corbaserver import ProblemSolver
from hpp.corbaserver.wholebody_step.client import Client as WsClient

robot = Robot ()
robot.setTranslationBounds (-0.5, 0.5, -3, 3, 0, 1)

client = robot.client

#q1=[0,1.5,0.64870180180254433111, 1,0,0,0 ,0,0,0,0,0.26179900000000000393,0.1745299999999999907,0,-0.52359900000000003661,0,0,0.1745319999999999927,-0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927,0.26179900000000000393,-0.1745299999999999907,0,-0.52359900000000003661,0,0,0.1745319999999999927,-0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927,0,0,-0.45378600000000002268,0.87266500000000002402,-0.41887900000000000134,0,0,0,-0.45378600000000002268,0.87266500000000002402,-0.41887900000000000134,0]
q1=[0,1.5,0.64870180180254433111, 0.9249114088877176,0,0,-0.38018270043406405,0,0,0,0,0.26179900000000000393,0.1745299999999999907,0,-0.52359900000000003661,0,0,0.1745319999999999927,-0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927,0.26179900000000000393,-0.1745299999999999907,0,-0.52359900000000003661,0,0,0.1745319999999999927,-0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927,0,0,-0.45378600000000002268,0.87266500000000002402,-0.41887900000000000134,0,0,0,-0.45378600000000002268,0.87266500000000002402,-0.41887900000000000134,0]

#q2=[0,-2.5,0.64870180180254433111, 1,0,0,0, 0,0,0,0,0.26179900000000000393, 0.1745299999999999907,0,-0.52359900000000003661,0,0,0.1745319999999999927, -0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927, 0.1745319999999999927,-0.1745319999999999927,0.26179900000000000393, -0.1745299999999999907,0,-0.52359900000000003661,0,0,0.1745319999999999927, -0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927, 0.1745319999999999927,-0.1745319999999999927,0,0,-0.45378600000000002268, 0.87266500000000002402,-0.41887900000000000134,0,0,0,-0.45378600000000002268, 0.87266500000000002402,-0.41887900000000000134,0]
q2=[0,-2.5,0.64870180180254433111, 0.7101853756232854, 0, 0, -0.7040147244559684, 0,0,0,0,0.26179900000000000393, 0.1745299999999999907,0,-0.52359900000000003661,0,0,0.1745319999999999927, -0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927, 0.1745319999999999927,-0.1745319999999999927,0.26179900000000000393, -0.1745299999999999907,0,-0.52359900000000003661,0,0,0.1745319999999999927, -0.1745319999999999927,0.1745319999999999927,-0.1745319999999999927, 0.1745319999999999927,-0.1745319999999999927,0,0,-0.45378600000000002268, 0.87266500000000002402,-0.41887900000000000134,0,0,0,-0.45378600000000002268, 0.87266500000000002402,-0.41887900000000000134,0]

qW=[0.0,0.0,0.38870180180254433111, 1,0,0,0, 
                0,0.14,0,-0.52,
                0, 1.57 ,0,0,0,0,0, 0,0,0,0,0,
                0, -1.57,0,0,0,0,0, 0,0,0,0,0,
                0,0,-1.22,2.16,-0.95,0,
                0,0,-1.22,2.16,-0.95,0]

qW2=[0.0,-0.8,0.38870180180254433111, 1,0,0,0, 
                0,0.14,0,-0.52,
                0, 1.57 ,0,0,0,0,0, 0,0,0,0,0,
                0, -1.57,0,0,0,0,0, 0,0,0,0,0,
                0,0,-1.22,2.16,-0.95,0,
                0,0,-1.22,2.16,-0.95,0]

## Add constraints
solver = ProblemSolver (robot)
solver.loadObstacleFromUrdf("hpp_ros","wall")

print "direct paths between waypoint and goal"
solver.directPath(q1,qW)
solver.directPath(qW,qW2)
solver.directPath(qW2,q2)

publisher = ScenePublisher(robot)
pathplayer = PathPlayer (client, publisher)

fn="trajectory-wall-direct-path.tau"
pathplayer.toFileAppend(0,fn)
pathplayer.toFileAppend(1,fn)
pathplayer.toFileAppend(2,fn)

pathplayer(0)
pathplayer(1)
pathplayer(2)
